import{a as xt,b as F,c as q,d as Q,e as L,f as K,g as k,h as J,i as Lt,j as Tt}from"./chunk-27X3XQL7.mjs";import"./chunk-XPDAOANJ.mjs";import"./chunk-M4DHSCZ5.mjs";import{b as pt}from"./chunk-WNGRW6ZO.mjs";import"./chunk-25QWRKWN.mjs";import{a as _t}from"./chunk-M5RPCIO7.mjs";import{a as St}from"./chunk-AUXUJQO7.mjs";import{J as wt,K as bt,T as kt,i as V,n as dt,x as b}from"./chunk-VMDNBU76.mjs";import"./chunk-LEAL3RNQ.mjs";import{c as X,d as $,p as gt}from"./chunk-EYGBHCO6.mjs";import"./chunk-EZ6AQD5Z.mjs";import{F as G,G as yt,Ja as vt,Ta as U,b as D,ca as ot,ga as lt,h as g,ha as ct,i as ft,k as mt}from"./chunk-PZJP3F4K.mjs";import"./chunk-RS46GSJM.mjs";import{a as l}from"./chunk-J73WXDYM.mjs";var Z={normal:ne,vee:se,undirected:ie};function Et(r){Z=r}l(Et,"setArrows");function ne(r,e,t,n){var a=r.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),s=a.append("path").attr("d","M 0 0 L 10 5 L 0 10 z").style("stroke-width",1).style("stroke-dasharray","1,0");L(s,t[n+"Style"]),t[n+"Class"]&&s.attr("class",t[n+"Class"])}l(ne,"normal");function se(r,e,t,n){var a=r.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),s=a.append("path").attr("d","M 0 0 L 10 5 L 0 10 L 4 5 z").style("stroke-width",1).style("stroke-dasharray","1,0");L(s,t[n+"Style"]),t[n+"Class"]&&s.attr("class",t[n+"Class"])}l(se,"vee");function ie(r,e,t,n){var a=r.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),s=a.append("path").attr("d","M 0 5 L 10 5").style("stroke-width",1).style("stroke-dasharray","1,0");L(s,t[n+"Style"]),t[n+"Class"]&&s.attr("class",t[n+"Class"])}l(ie,"undirected");function Ct(r,e){var t=r;return t.node().appendChild(e.label),L(t,e.labelStyle),t}l(Ct,"addSVGLabel");function Nt(r,e){for(var t=r.append("text"),n=oe(e.label).split(`
`),a=0;a<n.length;a++)t.append("tspan").attr("xml:space","preserve").attr("dy","1em").attr("x","1").text(n[a]);return L(t,e.labelStyle),t}l(Nt,"addTextLabel");function oe(r){for(var e="",t=!1,n,a=0;a<r.length;++a)if(n=r[a],t){switch(n){case"n":e+=`
`;break;default:e+=n}t=!1}else n==="\\"?t=!0:e+=n;return e}l(oe,"processEscapeSequences");function W(r,e,t){var n=e.label,a=r.append("g");e.labelType==="svg"?Ct(a,e):typeof n!="string"||e.labelType==="html"?J(a,e):Nt(a,e);var s=a.node().getBBox(),i;switch(t){case"top":i=-e.height/2;break;case"bottom":i=e.height/2-s.height;break;default:i=-s.height/2}return a.attr("transform","translate("+-s.width/2+","+i+")"),a}l(W,"addLabel");var O=l(function(r,e){var t=e.nodes().filter(function(s){return q(e,s)}),n=r.selectAll("g.cluster").data(t,function(s){return s});k(n.exit(),e).style("opacity",0).remove();var a=n.enter().append("g").attr("class","cluster").attr("id",function(s){var i=e.node(s);return i.id}).style("opacity",0).each(function(s){var i=e.node(s),o=g(this);g(this).append("rect");var d=o.append("g").attr("class","label");W(d,i,i.clusterLabelPos)});return n=n.merge(a),n=k(n,e).style("opacity",1),n.selectAll("rect").each(function(s){var i=e.node(s),o=g(this);L(o,i.style)}),n},"createClusters");function At(r){O=r}l(At,"setCreateClusters");var tt=l(function(r,e){var t=r.selectAll("g.edgeLabel").data(e.edges(),function(a){return Q(a)}).classed("update",!0);t.exit().remove(),t.enter().append("g").classed("edgeLabel",!0).style("opacity",0),t=r.selectAll("g.edgeLabel"),t.each(function(a){var s=g(this);s.select(".label").remove();var i=e.edge(a),o=W(s,e.edge(a),0).classed("label",!0),d=o.node().getBBox();i.labelId&&o.attr("id",i.labelId),b(i,"width")||(i.width=d.width),b(i,"height")||(i.height=d.height)});var n;return t.exit?n=t.exit():n=t.selectAll(null),k(n,e).style("opacity",0).remove(),t},"createEdgeLabels");function It(r){tt=r}l(It,"setCreateEdgeLabels");function ut(r,e){return r.intersect(e)}l(ut,"intersectNode");var et=l(function(r,e,t){var n=r.selectAll("g.edgePath").data(e.edges(),function(i){return Q(i)}).classed("update",!0),a=ue(n,e);he(n,e);var s=n.merge!==void 0?n.merge(a):n;return k(s,e).style("opacity",1),s.each(function(i){var o=g(this),d=e.edge(i);d.elem=this,d.id&&o.attr("id",d.id),K(o,d.class,(o.classed("update")?"update ":"")+"edgePath")}),s.selectAll("path.path").each(function(i){var o=e.edge(i);o.arrowheadId=kt("arrowhead");var d=g(this).attr("marker-end",function(){return"url("+ce(location.href,o.arrowheadId)+")"}).style("fill","none");k(d,e).attr("d",function(p){return de(e,p)}),L(d,o.style)}),s.selectAll("defs *").remove(),s.selectAll("defs").each(function(i){var o=e.edge(i),d=t[o.arrowhead];d(g(this),o.arrowheadId,o,"arrowhead")}),s},"createEdgePaths");function Mt(r){et=r}l(Mt,"setCreateEdgePaths");function ce(r,e){var t=r.split("#")[0];return t+"#"+e}l(ce,"makeFragmentRef");function de(r,e){var t=r.edge(e),n=r.node(e.v),a=r.node(e.w),s=t.points.slice(1,t.points.length-1);return s.unshift(ut(n,s[0])),s.push(ut(a,s[s.length-1])),Bt(t,s)}l(de,"calcPoints");function Bt(r,e){var t=(yt||mt.line)().x(function(n){return n.x}).y(function(n){return n.y});return(t.curve||t.interpolate)(r.curve),t(e)}l(Bt,"createLine");function pe(r){var e=r.getBBox(),t=r.ownerSVGElement.getScreenCTM().inverse().multiply(r.getScreenCTM()).translate(e.width/2,e.height/2);return{x:t.e,y:t.f}}l(pe,"getCoords");function ue(r,e){var t=r.enter().append("g").attr("class","edgePath").style("opacity",0);return t.append("path").attr("class","path").attr("d",function(n){var a=e.edge(n),s=e.node(n.v).elem,i=bt(a.points.length).map(function(){return pe(s)});return Bt(a,i)}),t.append("defs"),t}l(ue,"enter");function he(r,e){var t=r.exit();k(t,e).style("opacity",0).remove()}l(he,"exit");var rt=l(function(r,e,t){var n=e.nodes().filter(function(i){return!q(e,i)}),a=r.selectAll("g.node").data(n,function(i){return i}).classed("update",!0);a.exit().remove(),a.enter().append("g").attr("class","node").style("opacity",0),a=r.selectAll("g.node"),a.each(function(i){var o=e.node(i),d=g(this);K(d,o.class,(d.classed("update")?"update ":"")+"node"),d.select("g.label").remove();var p=d.append("g").attr("class","label"),c=W(p,o),y=t[o.shape],u=wt(c.node().getBBox(),"width","height");o.elem=this,o.id&&d.attr("id",o.id),o.labelId&&p.attr("id",o.labelId),b(o,"width")&&(u.width=o.width),b(o,"height")&&(u.height=o.height),u.width+=o.paddingLeft+o.paddingRight,u.height+=o.paddingTop+o.paddingBottom,p.attr("transform","translate("+(o.paddingLeft-o.paddingRight)/2+","+(o.paddingTop-o.paddingBottom)/2+")");var h=g(this);h.select(".label-container").remove();var m=y(h,u,o).classed("label-container",!0);L(m,o.style);var x=m.node().getBBox();o.width=x.width,o.height=x.height});var s;return a.exit?s=a.exit():s=a.selectAll(null),k(s,e).style("opacity",0).remove(),a},"createNodes");function Pt(r){rt=r}l(Pt,"setCreateNodes");function Rt(r,e){var t=r.filter(function(){return!g(this).classed("update")});function n(a){var s=e.node(a);return"translate("+s.x+","+s.y+")"}l(n,"translate"),t.attr("transform",n),k(r,e).style("opacity",1).attr("transform",n),k(t.selectAll("rect"),e).attr("width",function(a){return e.node(a).width}).attr("height",function(a){return e.node(a).height}).attr("x",function(a){var s=e.node(a);return-s.width/2}).attr("y",function(a){var s=e.node(a);return-s.height/2})}l(Rt,"positionClusters");function Dt(r,e){var t=r.filter(function(){return!g(this).classed("update")});function n(a){var s=e.edge(a);return b(s,"x")?"translate("+s.x+","+s.y+")":""}l(n,"translate"),t.attr("transform",n),k(r,e).style("opacity",1).attr("transform",n)}l(Dt,"positionEdgeLabels");function Gt(r,e){var t=r.filter(function(){return!g(this).classed("update")});function n(a){var s=e.node(a);return"translate("+s.x+","+s.y+")"}l(n,"translate"),t.attr("transform",n),k(r,e).style("opacity",1).attr("transform",n)}l(Gt,"positionNodes");function at(r,e,t,n){var a=r.x,s=r.y,i=a-n.x,o=s-n.y,d=Math.sqrt(e*e*o*o+t*t*i*i),p=Math.abs(e*t*i/d);n.x<a&&(p=-p);var c=Math.abs(e*t*o/d);return n.y<s&&(c=-c),{x:a+p,y:s+c}}l(at,"intersectEllipse");function Ut(r,e,t){return at(r,e,e,t)}l(Ut,"intersectCircle");function Wt(r,e,t,n){var a,s,i,o,d,p,c,y,u,h,m,x,f,v,T;if(a=e.y-r.y,i=r.x-e.x,d=e.x*r.y-r.x*e.y,u=a*t.x+i*t.y+d,h=a*n.x+i*n.y+d,!(u!==0&&h!==0&&Vt(u,h))&&(s=n.y-t.y,o=t.x-n.x,p=n.x*t.y-t.x*n.y,c=s*r.x+o*r.y+p,y=s*e.x+o*e.y+p,!(c!==0&&y!==0&&Vt(c,y))&&(m=a*o-s*i,m!==0)))return x=Math.abs(m/2),f=i*p-o*d,v=f<0?(f-x)/m:(f+x)/m,f=s*d-a*p,T=f<0?(f-x)/m:(f+x)/m,{x:v,y:T}}l(Wt,"intersectLine");function Vt(r,e){return r*e>0}l(Vt,"sameSign");function C(r,e,t){var n=r.x,a=r.y,s=[],i=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;e.forEach(function(m){i=Math.min(i,m.x),o=Math.min(o,m.y)});for(var d=n-r.width/2-i,p=a-r.height/2-o,c=0;c<e.length;c++){var y=e[c],u=e[c<e.length-1?c+1:0],h=Wt(r,t,{x:d+y.x,y:p+y.y},{x:d+u.x,y:p+u.y});h&&s.push(h)}return s.length?(s.length>1&&s.sort(function(m,x){var f=m.x-t.x,v=m.y-t.y,T=Math.sqrt(f*f+v*v),P=x.x-t.x,N=x.y-t.y,st=Math.sqrt(P*P+N*N);return T<st?-1:T===st?0:1}),s[0]):(console.log("NO INTERSECTION FOUND, RETURN NODE CENTER",r),r)}l(C,"intersectPolygon");function z(r,e){var t=r.x,n=r.y,a=e.x-t,s=e.y-n,i=r.width/2,o=r.height/2,d,p;return Math.abs(s)*i>Math.abs(a)*o?(s<0&&(o=-o),d=s===0?0:o*a/s,p=o):(a<0&&(i=-i),d=i,p=a===0?0:i*s/a),{x:t+d,y:n+p}}l(z,"intersectRect");var nt={rect:ve,ellipse:xe,circle:we,diamond:be};function zt(r){nt=r}l(zt,"setShapes");function ve(r,e,t){var n=r.insert("rect",":first-child").attr("rx",t.rx).attr("ry",t.ry).attr("x",-e.width/2).attr("y",-e.height/2).attr("width",e.width).attr("height",e.height);return t.intersect=function(a){return z(t,a)},n}l(ve,"rect");function xe(r,e,t){var n=e.width/2,a=e.height/2,s=r.insert("ellipse",":first-child").attr("x",-e.width/2).attr("y",-e.height/2).attr("rx",n).attr("ry",a);return t.intersect=function(i){return at(t,n,a,i)},s}l(xe,"ellipse");function we(r,e,t){var n=Math.max(e.width,e.height)/2,a=r.insert("circle",":first-child").attr("x",-e.width/2).attr("y",-e.height/2).attr("r",n);return t.intersect=function(s){return Ut(t,n,s)},a}l(we,"circle");function be(r,e,t){var n=e.width*Math.SQRT2/2,a=e.height*Math.SQRT2/2,s=[{x:0,y:-a},{x:-n,y:0},{x:0,y:a},{x:n,y:0}],i=r.insert("polygon",":first-child").attr("points",s.map(function(o){return o.x+","+o.y}).join(" "));return t.intersect=function(o){return C(t,s,o)},i}l(be,"diamond");function ht(){var r=l(function(e,t){_e(t);var n=H(e,"output"),a=H(n,"clusters"),s=H(n,"edgePaths"),i=tt(H(n,"edgeLabels"),t),o=rt(H(n,"nodes"),t,nt);_t(t),Gt(o,t),Dt(i,t),et(s,t,Z);var d=O(a,t);Rt(d,t),Le(t)},"fn");return r.createNodes=function(e){return arguments.length?(Pt(e),r):rt},r.createClusters=function(e){return arguments.length?(At(e),r):O},r.createEdgeLabels=function(e){return arguments.length?(It(e),r):tt},r.createEdgePaths=function(e){return arguments.length?(Mt(e),r):et},r.shapes=function(e){return arguments.length?(zt(e),r):nt},r.arrows=function(e){return arguments.length?(Et(e),r):Z},r}l(ht,"render");var ke={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:"rect"},Se={arrowhead:"normal",curve:G};function _e(r){r.nodes().forEach(function(e){var t=r.node(e);!b(t,"label")&&!r.children(e).length&&(t.label=e),b(t,"paddingX")&&V(t,{paddingLeft:t.paddingX,paddingRight:t.paddingX}),b(t,"paddingY")&&V(t,{paddingTop:t.paddingY,paddingBottom:t.paddingY}),b(t,"padding")&&V(t,{paddingLeft:t.padding,paddingRight:t.padding,paddingTop:t.padding,paddingBottom:t.padding}),V(t,ke),dt(["paddingLeft","paddingRight","paddingTop","paddingBottom"],function(n){t[n]=Number(t[n])}),b(t,"width")&&(t._prevWidth=t.width),b(t,"height")&&(t._prevHeight=t.height)}),r.edges().forEach(function(e){var t=r.edge(e);b(t,"label")||(t.label=""),V(t,Se)})}l(_e,"preProcessGraph");function Le(r){dt(r.nodes(),function(e){var t=r.node(e);b(t,"_prevWidth")?t.width=t._prevWidth:delete t.width,b(t,"_prevHeight")?t.height=t._prevHeight:delete t.height,delete t._prevWidth,delete t._prevHeight})}l(Le,"postProcessGraph");function H(r,e){var t=r.select("g."+e);return t.empty()&&(t=r.append("g").attr("class",e)),t}l(H,"createOrSelectGroup");function Ht(r,e,t){let n=e.width,a=e.height,s=(n+a)*.9,i=[{x:s/2,y:0},{x:s,y:-s/2},{x:s/2,y:-s},{x:0,y:-s/2}],o=I(r,s,s,i);return t.intersect=function(d){return C(t,i,d)},o}l(Ht,"question");function Yt(r,e,t){let a=e.height,s=a/4,i=e.width+2*s,o=[{x:s,y:0},{x:i-s,y:0},{x:i,y:-a/2},{x:i-s,y:-a},{x:s,y:-a},{x:0,y:-a/2}],d=I(r,i,a,o);return t.intersect=function(p){return C(t,o,p)},d}l(Yt,"hexagon");function Xt(r,e,t){let n=e.width,a=e.height,s=[{x:-a/2,y:0},{x:n,y:0},{x:n,y:-a},{x:-a/2,y:-a},{x:0,y:-a/2}],i=I(r,n,a,s);return t.intersect=function(o){return C(t,s,o)},i}l(Xt,"rect_left_inv_arrow");function $t(r,e,t){let n=e.width,a=e.height,s=[{x:-2*a/6,y:0},{x:n-a/6,y:0},{x:n+2*a/6,y:-a},{x:a/6,y:-a}],i=I(r,n,a,s);return t.intersect=function(o){return C(t,s,o)},i}l($t,"lean_right");function Ft(r,e,t){let n=e.width,a=e.height,s=[{x:2*a/6,y:0},{x:n+a/6,y:0},{x:n-2*a/6,y:-a},{x:-a/6,y:-a}],i=I(r,n,a,s);return t.intersect=function(o){return C(t,s,o)},i}l(Ft,"lean_left");function qt(r,e,t){let n=e.width,a=e.height,s=[{x:-2*a/6,y:0},{x:n+2*a/6,y:0},{x:n-a/6,y:-a},{x:a/6,y:-a}],i=I(r,n,a,s);return t.intersect=function(o){return C(t,s,o)},i}l(qt,"trapezoid");function Qt(r,e,t){let n=e.width,a=e.height,s=[{x:a/6,y:0},{x:n-a/6,y:0},{x:n+2*a/6,y:-a},{x:-2*a/6,y:-a}],i=I(r,n,a,s);return t.intersect=function(o){return C(t,s,o)},i}l(Qt,"inv_trapezoid");function Kt(r,e,t){let n=e.width,a=e.height,s=[{x:0,y:0},{x:n+a/2,y:0},{x:n,y:-a/2},{x:n+a/2,y:-a},{x:0,y:-a}],i=I(r,n,a,s);return t.intersect=function(o){return C(t,s,o)},i}l(Kt,"rect_right_inv_arrow");function Jt(r,e,t){let n=e.height,a=e.width+n/4,s=r.insert("rect",":first-child").attr("rx",n/2).attr("ry",n/2).attr("x",-a/2).attr("y",-n/2).attr("width",a).attr("height",n);return t.intersect=function(i){return z(t,i)},s}l(Jt,"stadium");function Zt(r,e,t){let n=e.width,a=e.height,s=[{x:0,y:0},{x:n,y:0},{x:n,y:-a},{x:0,y:-a},{x:0,y:0},{x:-8,y:0},{x:n+8,y:0},{x:n+8,y:-a},{x:-8,y:-a},{x:-8,y:0}],i=I(r,n,a,s);return t.intersect=function(o){return C(t,s,o)},i}l(Zt,"subroutine");function Ot(r,e,t){let n=e.width,a=n/2,s=a/(2.5+n/50),i=e.height+s,o="M 0,"+s+" a "+a+","+s+" 0,0,0 "+n+" 0 a "+a+","+s+" 0,0,0 "+-n+" 0 l 0,"+i+" a "+a+","+s+" 0,0,0 "+n+" 0 l 0,"+-i,d=r.attr("label-offset-y",s).insert("path",":first-child").attr("d",o).attr("transform","translate("+-n/2+","+-(i/2+s)+")");return t.intersect=function(p){let c=z(t,p),y=c.x-t.x;if(a!=0&&(Math.abs(y)<t.width/2||Math.abs(y)==t.width/2&&Math.abs(c.y-t.y)>t.height/2-s)){let u=s*s*(1-y*y/(a*a));u!=0&&(u=Math.sqrt(u)),u=s-u,p.y-t.y>0&&(u=-u),c.y+=u}return c},d}l(Ot,"cylinder");function Ce(r){r.shapes().question=Ht,r.shapes().hexagon=Yt,r.shapes().stadium=Jt,r.shapes().subroutine=Zt,r.shapes().cylinder=Ot,r.shapes().rect_left_inv_arrow=Xt,r.shapes().lean_right=$t,r.shapes().lean_left=Ft,r.shapes().trapezoid=qt,r.shapes().inv_trapezoid=Qt,r.shapes().rect_right_inv_arrow=Kt}l(Ce,"addToRender");function Ne(r){r({question:Ht}),r({hexagon:Yt}),r({stadium:Jt}),r({subroutine:Zt}),r({cylinder:Ot}),r({rect_left_inv_arrow:Xt}),r({lean_right:$t}),r({lean_left:Ft}),r({trapezoid:qt}),r({inv_trapezoid:Qt}),r({rect_right_inv_arrow:Kt})}l(Ne,"addToRenderV2");function I(r,e,t,n){return r.insert("polygon",":first-child").attr("points",n.map(function(a){return a.x+","+a.y}).join(" ")).attr("transform","translate("+-e/2+","+t/2+")")}l(I,"insertPolygonShape");var jt={addToRender:Ce,addToRenderV2:Ne};var te={},Ae=l(function(r){let e=Object.keys(r);for(let t of e)te[t]=r[t]},"setConf"),ee=l(async function(r,e,t,n,a,s){let i=n?n.select(`[id="${t}"]`):g(`[id="${t}"]`),o=a||document,d=Object.keys(r);for(let p of d){let c=r[p],y="default";c.classes.length>0&&(y=c.classes.join(" "));let u=$(c.styles),h=c.text!==void 0?c.text:c.id,m;if(ot(U().flowchart.htmlLabels)){let v=pt(h),T={label:await lt(v,U())};m=J(i,T).node(),m.parentNode.removeChild(m)}else{let v=o.createElementNS("http://www.w3.org/2000/svg","text");v.setAttribute("style",u.labelStyle.replace("color:","fill:"));let T=h.split(ct.lineBreakRegex);for(let P of T){let N=o.createElementNS("http://www.w3.org/2000/svg","tspan");N.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),N.setAttribute("dy","1em"),N.setAttribute("x","1"),N.textContent=P,v.appendChild(N)}m=v}let x=0,f="";switch(c.type){case"round":x=5,f="rect";break;case"square":f="rect";break;case"diamond":f="question";break;case"hexagon":f="hexagon";break;case"odd":f="rect_left_inv_arrow";break;case"lean_right":f="lean_right";break;case"lean_left":f="lean_left";break;case"trapezoid":f="trapezoid";break;case"inv_trapezoid":f="inv_trapezoid";break;case"odd_right":f="rect_left_inv_arrow";break;case"circle":f="circle";break;case"ellipse":f="ellipse";break;case"stadium":f="stadium";break;case"subroutine":f="subroutine";break;case"cylinder":f="cylinder";break;case"group":f="rect";break;default:f="rect"}D.warn("Adding node",c.id,c.domId),e.setNode(s.db.lookUpDomId(c.id),{labelType:"svg",labelStyle:u.labelStyle,shape:f,label:m,rx:x,ry:x,class:y,style:u.style,id:s.db.lookUpDomId(c.id)})}},"addVertices"),re=l(async function(r,e,t){let n=0,a,s;if(r.defaultStyle!==void 0){let i=$(r.defaultStyle);a=i.style,s=i.labelStyle}for(let i of r){n++;let o=gt(i.start,i.end,{counter:n,prefix:"L"}),d="LS-"+i.start,p="LE-"+i.end,c={};i.type==="arrow_open"?c.arrowhead="none":c.arrowhead="normal";let y="",u="";if(i.style!==void 0){let h=$(i.style);y=h.style,u=h.labelStyle}else switch(i.stroke){case"normal":y="fill:none",a!==void 0&&(y=a),s!==void 0&&(u=s);break;case"dotted":y="fill:none;stroke-width:2px;stroke-dasharray:3;";break;case"thick":y=" stroke-width: 3.5px;fill:none";break}c.style=y,c.labelStyle=u,i.interpolate!==void 0?c.curve=X(i.interpolate,G):r.defaultInterpolate!==void 0?c.curve=X(r.defaultInterpolate,G):c.curve=X(te.curve,G),i.text===void 0?i.style!==void 0&&(c.arrowheadStyle="fill: #333"):(c.arrowheadStyle="fill: #333",c.labelpos="c",ot(U().flowchart.htmlLabels)?(c.labelType="html",c.label=`<span id="L-${o}" class="edgeLabel L-${d}' L-${p}" style="${c.labelStyle}">${await lt(pt(i.text),U())}</span>`):(c.labelType="text",c.label=i.text.replace(ct.lineBreakRegex,`
`),i.style===void 0&&(c.style=c.style||"stroke: #333; stroke-width: 1.5px;fill:none"),c.labelStyle=c.labelStyle.replace("color:","fill:"))),c.id=o,c.class=d+" "+p,c.minlen=i.length||1,e.setEdge(t.db.lookUpDomId(i.start),t.db.lookUpDomId(i.end),c,n)}},"addEdges"),Ie=l(function(r,e){return D.info("Extracting classes"),e.db.getClasses()},"getClasses"),Me=l(async function(r,e,t,n){D.info("Drawing flowchart");let{securityLevel:a,flowchart:s}=U(),i;a==="sandbox"&&(i=g("#i"+e));let o=a==="sandbox"?g(i.nodes()[0].contentDocument.body):g("body"),d=a==="sandbox"?i.nodes()[0].contentDocument:document,p=n.db.getDirection();p===void 0&&(p="TD");let c=s.nodeSpacing||50,y=s.rankSpacing||50,u=new St({multigraph:!0,compound:!0}).setGraph({rankdir:p,nodesep:c,ranksep:y,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),h,m=n.db.getSubGraphs();for(let w=m.length-1;w>=0;w--)h=m[w],n.db.addVertex(h.id,h.title,"group",void 0,h.classes);let x=n.db.getVertices();D.warn("Get vertices",x);let f=n.db.getEdges(),v=0;for(v=m.length-1;v>=0;v--){h=m[v],ft("cluster").append("text");for(let w=0;w<h.nodes.length;w++)D.warn("Setting subgraph",h.nodes[w],n.db.lookUpDomId(h.nodes[w]),n.db.lookUpDomId(h.id)),u.setParent(n.db.lookUpDomId(h.nodes[w]),n.db.lookUpDomId(h.id))}await ee(x,u,e,o,d,n),await re(f,u,n);let T=new ht;jt.addToRender(T),T.arrows().none=l(function(_,E,S,R){let M=_.append("marker").attr("id",E).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 0 0 L 0 0 z");L(M,S[R+"Style"])},"normal"),T.arrows().normal=l(function(_,E){_.append("marker").attr("id",E).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowheadPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"normal");let P=o.select(`[id="${e}"]`),N=o.select("#"+e+" g");for(T(N,u),N.selectAll("g.node").attr("title",function(){return n.db.getTooltip(this.id)}),n.db.indexNodes("subGraph"+v),v=0;v<m.length;v++)if(h=m[v],h.title!=="undefined"){let w=d.querySelectorAll("#"+e+' [id="'+n.db.lookUpDomId(h.id)+'"] rect'),_=d.querySelectorAll("#"+e+' [id="'+n.db.lookUpDomId(h.id)+'"]'),E=w[0].x.baseVal.value,S=w[0].y.baseVal.value,R=w[0].width.baseVal.value,M=g(_[0]).select(".label");M.attr("transform",`translate(${E+R/2}, ${S+14})`),M.attr("id",e+"Text");for(let it=0;it<h.classes.length;it++)_[0].classList.add(h.classes[it])}if(!s.htmlLabels){let w=d.querySelectorAll('[id="'+e+'"] .edgeLabel .label');for(let _ of w){let E=_.getBBox(),S=d.createElementNS("http://www.w3.org/2000/svg","rect");S.setAttribute("rx",0),S.setAttribute("ry",0),S.setAttribute("width",E.width),S.setAttribute("height",E.height),_.insertBefore(S,_.firstChild)}}vt(u,P,s.diagramPadding,s.useMaxWidth),[...x.keys()].forEach(function(w){let _=x.get(w);if(_.link){let E=o.select("#"+e+' [id="'+n.db.lookUpDomId(w)+'"]');if(E){let S=d.createElementNS("http://www.w3.org/2000/svg","a");S.setAttributeNS("http://www.w3.org/2000/svg","class",_.classes.join(" ")),S.setAttributeNS("http://www.w3.org/2000/svg","href",_.link),S.setAttributeNS("http://www.w3.org/2000/svg","rel","noopener"),a==="sandbox"?S.setAttributeNS("http://www.w3.org/2000/svg","target","_top"):_.linkTarget&&S.setAttributeNS("http://www.w3.org/2000/svg","target",_.linkTarget);let R=E.insert(function(){return S},":first-child"),Y=E.select(".label-container");Y&&R.append(function(){return Y.node()});let M=E.select(".label");M&&R.append(function(){return M.node()})}}})},"draw"),ae={setConf:Ae,addVertices:ee,addEdges:re,getClasses:Ie,draw:Me};var sa={parser:xt,db:F,renderer:Lt,styles:Tt,init:r=>{r.flowchart||(r.flowchart={}),r.flowchart.arrowMarkerAbsolute=r.arrowMarkerAbsolute,ae.setConf(r.flowchart),F.clear(),F.setGen("gen-1")}};export{sa as diagram};
