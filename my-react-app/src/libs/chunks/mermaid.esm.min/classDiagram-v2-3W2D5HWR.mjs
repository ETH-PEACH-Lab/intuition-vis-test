import{a as _,b as N,c as z}from"./chunk-7RZDONNX.mjs";import{a as P}from"./chunk-MZJD37A6.mjs";import"./chunk-6PBAZYZY.mjs";import"./chunk-4DYLSDN7.mjs";import"./chunk-25QWRKWN.mjs";import"./chunk-M5RPCIO7.mjs";import{a as B}from"./chunk-AUXUJQO7.mjs";import"./chunk-VMDNBU76.mjs";import"./chunk-LEAL3RNQ.mjs";import{c as S,d as C,m as A,p as G}from"./chunk-JT6TYY6Y.mjs";import"./chunk-EZ6AQD5Z.mjs";import{F as T,Ja as I,Ta as l,b as i,h as w,ha as k}from"./chunk-3RIG7DRU.mjs";import"./chunk-RS46GSJM.mjs";import{a as c}from"./chunk-J73WXDYM.mjs";var E=c(s=>k.sanitizeText(s,l()),"sanitizeText"),D={dividerMargin:10,padding:5,textHeight:10,curve:void 0},V=c(function(s,a,d,n){i.info("keys:",[...s.keys()]),i.info(s),s.forEach(function(e){let o={shape:"rect",id:e.id,domId:e.domId,labelText:E(e.id),labelStyle:"",style:"fill: none; stroke: black",padding:l().flowchart?.padding??l().class?.padding};a.setNode(e.id,o),q(e.classes,a,d,n,e.id),i.info("setNode",o)})},"addNamespaces"),q=c(function(s,a,d,n,e){i.info("keys:",[...s.keys()]),i.info(s),[...s.values()].filter(t=>t.parent===e).forEach(function(t){let o=t.cssClasses.join(" "),f=C(t.styles),r=t.label??t.id,y=0,p={labelStyle:f.labelStyle,shape:"class_box",labelText:E(r),classData:t,rx:y,ry:y,class:o,style:f.style,id:t.id,domId:t.domId,tooltip:n.db.getTooltip(t.id,e)||"",haveCallback:t.haveCallback,link:t.link,width:t.type==="group"?500:void 0,type:t.type,padding:l().flowchart?.padding??l().class?.padding};a.setNode(t.id,p),e&&a.setParent(t.id,e),i.info("setNode",p)})},"addClasses"),W=c(function(s,a,d,n){i.info(s),s.forEach(function(e,t){let o=e,f="",r={labelStyle:"",style:""},y=o.text,m=0,h={labelStyle:r.labelStyle,shape:"note",labelText:E(y),noteData:o,rx:m,ry:m,class:f,style:r.style,id:o.id,domId:o.id,tooltip:"",type:"note",padding:l().flowchart?.padding??l().class?.padding};if(a.setNode(o.id,h),i.info("setNode",h),!o.class||!n.has(o.class))return;let b=d+t,u={id:`edgeNote${b}`,classes:"relation",pattern:"dotted",arrowhead:"none",startLabelRight:"",endLabelLeft:"",arrowTypeStart:"none",arrowTypeEnd:"none",style:"fill:none",labelStyle:"",curve:S(D.curve,T)};a.setEdge(o.id,o.class,u,b)})},"addNotes"),J=c(function(s,a){let d=l().flowchart,n=0;s.forEach(function(e){n++;let t={classes:"relation",pattern:e.relation.lineType==1?"dashed":"solid",id:G(e.id1,e.id2,{prefix:"id",counter:n}),arrowhead:e.type==="arrow_open"?"none":"normal",startLabelRight:e.relationTitle1==="none"?"":e.relationTitle1,endLabelLeft:e.relationTitle2==="none"?"":e.relationTitle2,arrowTypeStart:$(e.relation.type1),arrowTypeEnd:$(e.relation.type2),style:"fill:none",labelStyle:"",curve:S(d?.curve,T)};if(i.info(t,e),e.style!==void 0){let o=C(e.style);t.style=o.style,t.labelStyle=o.labelStyle}e.text=e.title,e.text===void 0?e.style!==void 0&&(t.arrowheadStyle="fill: #333"):(t.arrowheadStyle="fill: #333",t.labelpos="c",l().flowchart?.htmlLabels??l().htmlLabels?(t.labelType="html",t.label='<span class="edgeLabel">'+e.text+"</span>"):(t.labelType="text",t.label=e.text.replace(k.lineBreakRegex,`
`),e.style===void 0&&(t.style=t.style||"stroke: #333; stroke-width: 1.5px;fill:none"),t.labelStyle=t.labelStyle.replace("color:","fill:"))),a.setEdge(e.id1,e.id2,t,n)})},"addRelations"),K=c(function(s){D={...D,...s}},"setConf"),Q=c(async function(s,a,d,n){i.info("Drawing class - ",a);let e=l().flowchart??l().class,t=l().securityLevel;i.info("config:",e);let o=e?.nodeSpacing??50,f=e?.rankSpacing??50,r=new B({multigraph:!0,compound:!0}).setGraph({rankdir:n.db.getDirection(),nodesep:o,ranksep:f,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),y=n.db.getNamespaces(),m=n.db.getClasses(),p=n.db.getRelations(),h=n.db.getNotes();i.info(p),V(y,r,a,n),q(m,r,a,n),J(p,r),W(h,r,p.length+1,m);let b;t==="sandbox"&&(b=w("#i"+a));let u=t==="sandbox"?w(b.nodes()[0].contentDocument.body):w("body"),L=u.select(`[id="${a}"]`),F=u.select("#"+a+" g");if(await P(F,r,["aggregation","extension","composition","dependency","lollipop"],"classDiagram",a),A.insertTitle(L,"classTitleText",e?.titleTopMargin??5,n.db.getDiagramTitle()),I(r,L,e?.diagramPadding,e?.useMaxWidth),!e?.htmlLabels){let M=t==="sandbox"?b.nodes()[0].contentDocument:document,H=M.querySelectorAll('[id="'+a+'"] .edgeLabel .label');for(let x of H){let R=x.getBBox(),g=M.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("rx",0),g.setAttribute("ry",0),g.setAttribute("width",R.width),g.setAttribute("height",R.height),x.insertBefore(g,x.firstChild)}}},"draw");function $(s){let a;switch(s){case 0:a="aggregation";break;case 1:a="extension";break;case 2:a="composition";break;case 3:a="dependency";break;case 4:a="lollipop";break;default:a="none"}return a}c($,"getArrowMarker");var v={setConf:K,draw:Q};var ce={parser:_,db:N,renderer:v,styles:z,init:s=>{s.class||(s.class={}),s.class.arrowMarkerAbsolute=s.arrowMarkerAbsolute,N.clear()}};export{ce as diagram};
